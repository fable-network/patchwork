!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("patchwork",[],n):"object"==typeof exports?exports.patchwork=n():e.patchwork=n()}(window,function(){return function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="/dist/",t(t.s=4)}([function(e,n){e.exports=require("react")},function(e,n,t){e.exports=t(3)},function(e,n){e.exports=require("react-dom")},function(e,n){e.exports=require("regenerator-runtime")},function(e,n,t){"use strict";function r(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=[],r=!0,o=!1,u=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(t.push(c.value),!n||t.length!==n);r=!0);}catch(e){o=!0,u=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw u}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},u=Object.keys(e);for(r=0;r<u.length;r++)t=u[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(r=0;r<u.length;r++)t=u[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}t.r(n);var u=t(0),c=t.n(u),i=t(1),f=t.n(i);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.forEach(function(n){a(e,n,t[n])})}return e}function s(e,n,t,r,o,u,c){try{var i=e[u](c),f=i.value}catch(e){return void t(e)}i.done?n(f):Promise.resolve(f).then(r,o)}var p={},d={};function m(){"function"!=typeof window.define&&(window.define=function(){var e,n=(e=f.a.mark(function e(n,t){var r,u,c,i;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=("function"==typeof n?n:t)(),u=r.bootstrap,c=r.mount,i=r.unmount,u().then(function(e){var n=e.name,t=o(e,["name"]);console.log(">>>>> Registered child app: ",n),p[n]=l({mount:c,unmount:i},t),d[n]&&(d[n].forEach(function(e){return e(p[n])}),delete d[n])});case 4:case"end":return e.stop()}},e)}),function(){var n=this,t=arguments;return new Promise(function(r,o){var u=e.apply(n,t);function c(e){s(u,r,o,c,i,"next",e)}function i(e){s(u,r,o,c,i,"throw",e)}c(void 0)})});return function(e,t){return n.apply(this,arguments)}}(),window.define.amd=!0)}window.__test=function(){return{APPS:p,subscriptions:d}};var b=function(e){var n=e.name,t=e.componentName,i=void 0===t?null:t,f=e.basePath,a=o(e,["name","componentName","basePath"]),l=c.a.createRef(),s=r(Object(u.useState)(!1),2),m=s[0],b=s[1];return Object(u.useEffect)(function(){var e=null,t=null;return m?(console.log(">>> Now mounted, ref is:",l),t=function(e,n,t){return d[e]||(d[e]=[]),p[e]?(t(p[e]),function(){}):(d[e].push(t),function(){console.log(">>>> unsubscribe called:",e,n),d[e]=d[e].filter(function(e){return e!==t})})}(n,i,function(t){var r=t.components,u=void 0===r?{}:r,c=o(t,["components"]),s=null===i?c:u[i];if(s){var p=s.mount,d=s.unmount;console.log(">>>> calling ",n,i||"","MOUNT on",l.current),p(l.current,f,a),e=d}}),function(){if(e)return console.log(">>>> calling ",n,i||"","UNMOUNT on",l.current),e().then(function(){return t()}).catch(function(){return t()});t()}):(console.log(">>> Not mounted yet, let us call subscribe later"),b(!0),function(){console.log(">>>> Useless clean up")})},[n,i,m]),c.a.createElement("div",{ref:l})},y=t(2),v=t.n(y),h=function(e,n,t){return{name:e,mount:function(e){return v.a.render(c.a.createElement(n,t),e),Promise.resolve()},unmount:function(){return Promise.resolve()}}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];m(),Object.keys(e).forEach(function(n){var t=document.createElement("script");t.setAttribute("src",e[n]),document.body.appendChild(t)})};t.d(n,"registerComponent",function(){return h}),t.d(n,"registerManifest",function(){return g}),t.d(n,"PatchworkComponent",function(){return b});n.default=b}])});